/*******************************************
 * SPDX-License-Identifier: GPL-2.0-only   *
 * Copyright (C) 2017-2022  Martin Wolters *
 *******************************************/

#include <stdint.h>

static uint8_t ldtest[] = {
	0xa9, 0x40,			// 0000	lda #$40
	0x85, 0xff,			// 0002	sta $ff
	0x8d, 0x00, 0x01,	// 0004	sta $0100

	0xa9, 0x50,			// 0007	lda #$50
	0x85, 0xb0,			// 0009	sta $b0
	0x85, 0xb1,			// 000b	sta $b1

	0xa9, 0x0f,			// 000d lda #$0f
	0x8d, 0x40, 0x40,	// 000f sta $4040
	0xa9, 0xf0,			// 0012 lda #$f0
	0x8d, 0x60, 0x40,	// 0014 sta $4060

	0xa9, 0x00,			// 0017 lda #$00
	0xa2, 0x10,			// 0019 ldx #$10
	0xa0, 0x20,			// 001b ldy #$20

	0xa1, 0xef,			// 001d lda ($ef, x)
	0xb1, 0xff,			// 001f lda ($ff), y
	0x00				// 0021 BRK
};

static uint8_t jsrtest[] = {
	0x20, 0x03, 0x00,	// JSR $0003
	0x68,				// PLA
	0x68,				// PLA
	0xa9, 0xde,			// STA $de
	0x00				// BRK
};

static uint8_t stacktest[] = {
	0x20, 0x09, 0x00,	// 0000		JSR $0009
	0x4c, 0x14, 0x00,	// 0003		JMP $0014

	0xa9, 0x78,			// 0006		LDA #$78
	0x60,				// 0008		RTS
	0xa9, 0x00,			// 0009		LDA	#$00
	0x48,				// 000b		PHA
	0xa9, 0x05,			// 000c		LDA #$05
	0x48,				// 000e		PHA
	0xa2, 0x34,			// 000f		LDX #$34
	0xa0, 0x56,			// 0011		LDY #$56
	0x60,				// 0013		RTS

	0xa8,				// 0014		TAY
	0x88,				// 0015		DEY
	0x8a,				// 0016		TXA
	0xe8,				// 0017		INX
	0xaa,				// 0018		TAX
	0xca,				// 0019		DEX
	0x98,				// 001a		TYA
	0xc8,				// 001b		INY
	0x00				// 001c		BRK
};

static uint8_t zeropage[] = {
	0xa9, 0x11,			// 0x0000	LDA #$11
	0x8d, 0xff, 0x30,	// 0x0002	STA $30ff
	0xa9, 0x00,			// 0x0005	LDA #$00
	0x8d, 0x00, 0x30,	// 0x0007	STA $3000
	0xa9, 0xfe,			// 0x000a	LDA #$fe
	0x6c, 0xff, 0x30,	// 0x000c	JMP ($30ff)
	0xa9, 0xef,			// 0x000f	LDA #$ef
	0xa2, 0x12,			// 0x0011	LDX #$12
	0xa0, 0x23,			// 0x0013	LDY #$23
	0x00				// 0x0015	BRK
};

static uint8_t stox[] = {
	0xa9, 0xff,			// 0x0000	LDA #$ff
	0xa2, 0x10,			// 0x0002	LDX	#$10
	0xa0, 0x20,			// 0x0004	LDY #$20

	0x86, 0xee,			// 0x0006	STX $ee
	0x96, 0xdd,			// 0x0008	STX $dd, Y
	0x8e, 0x00, 0xcc,	// 0x000a	STX $cc00

	0x84, 0xbb,			// 0x000d	STY $bb
	0x94, 0xaa,			// 0x000f	STY $aa, X
	0x8c, 0x99, 0x88,	// 0x0011	STY $8899

	0x00				// 0x0014	BRK
};

/* ADC negative/overflow/zero/carry flag test */
static uint8_t overtest[] = {
										// 0x0000	CLV
										// 0x0001	CLC
										// 0x0002	LDA #$7f
										// 0x0004	ADC #$01
										// etc...

	0xb8, 0x18, 0xa9, 0x7f, 0x69, 0x01,	// 0x7f + 0x01 = 0x80 N---
	0xb8, 0x18,	0xa9, 0x01, 0x69, 0xff,	// 0x01 + 0xff = 0x00 --ZC
	0xb8, 0x18, 0xa9, 0x50, 0x69, 0x10,	// 0x50 + 0x10 = 0x60 ----
	0xb8, 0x18, 0xa9, 0x50, 0x69, 0x50,	// 0x50 + 0x50 = 0xa0 NV--
	0xb8, 0x18, 0xa9, 0x50, 0x69, 0x90,	// 0x50 + 0x90 = 0xe0 N---
	0xb8, 0x18, 0xa9, 0x50, 0x69, 0xd0,	// 0x50 + 0xd0 = 0x20 ---C
	0xb8, 0x18, 0xa9, 0xd0, 0x69, 0x10,	// 0xd0 + 0x10 = 0xe0 N---
	0xb8, 0x18, 0xa9, 0xd0, 0x69, 0x50,	// 0xd0 + 0x50 = 0x20 ---C
	0xb8, 0x18, 0xa9, 0xd0, 0x69, 0x90,	// 0xd0 + 0x90 = 0x60 -V-C
	0xb8, 0x18, 0xa9, 0xd0, 0x69, 0xd0,	// 0xd0 + 0xd0 = 0xa0 N--C
	0x00
};

static uint8_t bittest[] = {
	0xa9, 0xd0,			// 0x0000 LDA #$d0
	0x85, 0xb0,			// 0x0002 STA $b0
	0xa9, 0x80,			// 0x0004 LDA #$80
	0x85, 0xb1,			// 0x0006 STA $b1
	0xa9, 0x3f,			// 0x0008 LDA #$3f
	0x85, 0xb2,			// 0x000a STA $b2

	0xa9, 0xff,			// 0x000c LDA #$ff
	0x24, 0xb0,			// 0x000e BIT $b0	NV--
	0xa9, 0xff,			// 0x0010 LDA #$ff
	0x24, 0xb1,			// 0x0012 BIT $b1	N---
	0xa9, 0xc0,			// 0x0014 LDA #$c0
	0x24, 0xb2,			// 0x0016 BIT $b2	--Z-

	0x00				// 0x0018 BRK
};

static uint8_t shifttest[] = {
	0xa9, 0x81,			// 0x0000 LDA #$81
	0x8d, 0x00, 0x40,	// 0x0002 STA $4000
	0xa9, 0xff,			// 0x0005 LDA #$ff
	0x0e, 0x00, 0x40,	// 0x0007 ASL $4000
	0xad, 0x00, 0x40,	// 0x000a LDA $4000
	0x00				// 0x000d BRK
};

static uint8_t branchtest[] = {
	0xa9, 0x7f,			// 0x0000 LDA #$7f
	0xf0, 0xfd,			// 0x0002 BEQ -2	// NOT TAKEN!
	0xa9, 0x00,			// 0x0004 LDA #$00
	0xf0, 0x03,			// 0x0006 BEQ 3		// TAKEN!
	0xa9, 0xee,			// 0x0008 LDA #$ee
	0x00,				// 0x0009 BRK
	0xa9, 0xdd,			// 0x000b LDA #$dd
	0x00				// 0x000d BRK
};

static uint8_t adddectest[] = {
	0xf8,				// 0x0000 SED
	0x38,				// 0x0001 SEC
	0xa9, 0x29,			// 0x0002 LDA #$29
	0x69, 0x12,			// 0x0003 ADC #$12
	0x4c, 0x06,			// 0x0005 JMP $06
	0x00				// 0x0007 BRK
};

#define DECTEST(data) \
	uint8_t *prog = data; \
	size_t progsize = sizeof(data)

DECTEST(adddectest);